{
  "definition": {
    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
    "contentVersion": "1.0.0.0",
    "triggers": {
      "When_a_row_is_added_modified_or_deleted": {
        "type": "OpenApiConnectionWebhook",
        "inputs": {
          "host": {
            "connectionName": "shared_commondataserviceforapps",
            "operationId": "SubscribeWebhookTrigger",
            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
          },
          "parameters": {
            "subscriptionRequest/message": 3,
            "subscriptionRequest/entityname": "contact",
            "subscriptionRequest/scope": 4,
            "subscriptionRequest/filteringattributes": "firstname,lastname,emailaddress1,telephone1,statecode"
          }
        }
      }
    },
    "actions": {
      "Send_to_AuthScape_Webhook": {
        "type": "Http",
        "inputs": {
          "method": "POST",
          "uri": "https://YOUR-AUTHSCAPE-DOMAIN/api/crm/webhook/dynamics/YOUR-CONNECTION-ID",
          "headers": {
            "Content-Type": "application/json"
          },
          "body": {
            "MessageName": "@{triggerOutputs()?['body/SdkMessage']}",
            "PrimaryEntityName": "contact",
            "PrimaryEntityId": "@{triggerOutputs()?['body/contactid']}",
            "InputParameters": [
              {
                "key": "Target",
                "value": {
                  "firstname": "@{triggerOutputs()?['body/firstname']}",
                  "lastname": "@{triggerOutputs()?['body/lastname']}",
                  "emailaddress1": "@{triggerOutputs()?['body/emailaddress1']}",
                  "telephone1": "@{triggerOutputs()?['body/telephone1']}",
                  "statecode": "@{triggerOutputs()?['body/statecode']}"
                }
              }
            ]
          }
        },
        "runAfter": {}
      }
    },
    "outputs": {}
  },
  "connectionReferences": {
    "shared_commondataserviceforapps": {
      "connectionName": "shared_commondataserviceforapps",
      "source": "Invoker",
      "id": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps",
      "tier": "NotSpecified"
    }
  }
}
